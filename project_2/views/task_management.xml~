<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <menuitem id="menu_task_management_root"
        name="Task Management"
        sequence="51"/>
    <menuitem name="Search"
        id="menu_task_management"
        parent="menu_task_management_root"
        sequence="2" />
    <menuitem name="Reports"
        id="menu_task_management_report"
        parent="menu_task_management_root"
        sequence="3" />
    <menuitem name="configuration"
        id="menu_task_management_config"
        parent="menu_task_management_root"
        sequence="4" />
    
    <record id="view_task_management_form" model="ir.ui.view">
        <field name="name">view.task.management.form</field>
        <field name="model">task.management</field>
        <field name="arch" type="xml">
            <form string="Tasks">
                <header>
                    <button name="start_timer" type="object" string="Start time"
                            attrs="{'invisible':['|',('is_user_working','=',True),
                            ('state','in',['completed','drop'])]}"/>
                    <button name="pause_timer" type="object" string="Pause time"
                            attrs="{'invisible':['|',('is_user_working','=',False),
                            ('state','in',['completed','drop'])]}"/>
                    <button name="stop_timer" type="object" string="Stop time"
                            attrs="{'invisible':[('is_user_working','=',False),
                            ('state','in',['drop'])]}"/>
                    <button name="drop_task" type="object" string="Drop"
                            attrs="{'invisible':[('state','in',['completed','drop','in_progress'])]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,in_progress,completed"
                           options="{'fold_field': 'fold'}"/>
                </header>
                <br></br>
                <div class="oe_title">
                    <h1 class="o_row">
                        <field name="task_priority" widget="priority"/>
                    </h1>
                    <h1 class="o_row">
                        <field name="name" placeholder="Task Title..." required="True"/>
                    </h1>
                </div>
                <group>
                    <group>
                        <field name="subject"/>
                        <field name="task_type"/>
                        <field name="reviewer" class="o_task_user_field" options='{"no_open": True}'/>
                        <field name="assigned_to" class="o_task_user_field" options='{"no_open": True}'/>
                        <field name="estimated_start_date" required="1"/>
                        <field name="estimated_end_date" required="1"/>
                        <field name="is_user_working" invisible="1"/>
                        <field name="task_drop_boolean" invisible="1"/>
                    </group>
                    <group>
                        <field name="deadline"/>
                        <field name="tag_ids" widget="many2many_tags" options="{'no_create_edit': True}"/>
                        <field name="start_time" invisible="1"/>
                        <field name="pause_time" invisible="1"/>
                        <field name="stop_time" invisible="1"/>
                        <field name="real_duration" invisible="1"/>
                        <field name="time_spent" />
                    </group>
                </group>
                <notebook>
                    <page name="description_page" string="Description">
                        <field name="description" type="html"/>
                        <div class="oe_clear"/>
                    </page>
                    <page name="check_list_page" string="Check List">
                        <field name="check_list_id" editable="bottom">
                            <tree string="Check List" editable="bottom">
                                <field name="name"/>
                                <field name="state" readonly="1" />
                            </tree>
                        </field>
                    </page>
                </notebook>
            </form> 
        </field>
    </record>
    
    <record id="view_task_management_tree" model="ir.ui.view">
        <field name="name">view.task.management.tree</field>
        <field name="model">task.management</field>
        <field eval="2" name="priority"/>
        <field name="arch" type="xml">
            <tree string="Tasks">
                <field name="name"/>
                <field name="reviewer"/>
                <field name="assigned_to"/>
                <field name="deadline"/>
                <field name="state"/>
            </tree>
        </field>
    </record>
    
    <record id="action_view_task_mangement" model="ir.actions.act_window">
        <field name="name">Tasks</field>
        <field name="res_model">task.management</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p>
                Custom task management.
            </p>
        </field>
    </record>
    
    <menuitem action="action_view_task_mangement" id="menu_action_view_task_management"
              parent="menu_task_management" sequence="5"/>

</odoo>